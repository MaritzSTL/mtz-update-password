<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html">
<link rel="import" href="../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../paper-input/paper-input.html">

<!--
`mtz-update-password`
Takes a password in from the user and validates it against a set of requirements.

@demo demo/index.html
-->

<dom-module id="mtz-update-password">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <slot name="title"></slot>
    <paper-input
      value="{{value}}"
    ></paper-input>
    <template
      is="dom-if"
      if="[[!disableRetype]]">
      <paper-input
        value="{{_secondValue}}"
      ></paper-input>
    </template>
    <template
      is="dom-if"
      if="[[!disableValidStatus]]">
      <!-- TODO: add valid status display -->
    </template>
  </template>

  <script>
    Polymer({
      is: 'mtz-update-password',
      behaviors: [Polymer.IronFormElementBehavior, Polymer.IronValidatableBehavior],
      properties: {
        /* Removes the requirement for entering a password twice */
        disableRetype: {
          type: Boolean,
          value: false
        },
        /* Removes the status section showing if you've hit all the requirements or not */
        disableValidStatus: {
          type: Boolean,
          value: false
        },
        /* Minimum number of capital letters required */
        minCapitals: {
          type: Number,
          value: 1
        },
        /* Minimum number of numbers required */
        minNumbers: {
          type: Number,
          value: 1
        },
        /* Minimum number of symbols required, valid symbols are defined by the symbols property */
        minSymbols: {
          type: Number,
          value: 1
        },
        /* A regex containing all valid symbols */
        symbols: {
          type: String,
          value: /[!@\$&*]/
        },
        /* User entered password */
        value: {
          type: String,
          notify: true
        },
        /**
         * The second user entered password to validate against
         * @private
         */
        _secondValue: String,
      },
      listeners: {
        'iron-form-element-register': '_blockChildEvent',
        'iron-form-element-unregister': '_blockChildEvent'
      },
      /**
       * Blocks event propagation for the registered events when it's not fired by this element.  Used to keep inner
       *  form elements from registering to the wrapping form.
       *
       * @private
       * @listens iron-form-element-register
       * @listens iron-form-element-unregister
       * @param {Object} event
       */
      _blockChildEvent(event) {
        if (event.target.is !== this.is) event.stopPropagation();
      },
      /**
       * Overrides the default functionality for validation on this element.  Takes all requirements into account.
       *
       * @private
       * @param {String} value
       * @returns {Boolean} - true if value is valid
       */
      _getValidity(value) {

      },
    });
  </script>
</dom-module>
